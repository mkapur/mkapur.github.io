<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="MSK">
<meta name="dcterms.date" content="2020-05-21">

<title>Maia Sosa Kapur - Some Algebra for Equilibrium Recruitment</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Maia Sosa Kapur</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home &amp; Blog Posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../publications.html">
 <span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://scholar.google.com/citations?user=H6AeRamFmxUC&amp;hl=en">
 <span class="menu-text">Google Scholar</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#the-bev-holt-srr" id="toc-the-bev-holt-srr" class="nav-link active" data-scroll-target="#the-bev-holt-srr">The Bev-Holt SRR</a></li>
  <li><a href="#yield-per-recruit-quantities-at-various-f" id="toc-yield-per-recruit-quantities-at-various-f" class="nav-link" data-scroll-target="#yield-per-recruit-quantities-at-various-f">Yield-per-Recruit quantities at various F</a></li>
  <li><a href="#srr-in-terms-of-sbpr" id="toc-srr-in-terms-of-sbpr" class="nav-link" data-scroll-target="#srr-in-terms-of-sbpr">SRR in terms of SBPR</a>
  <ul class="collapse">
  <li><a href="#alpha-beta-in-terms-of-steepness-recruitment" id="toc-alpha-beta-in-terms-of-steepness-recruitment" class="nav-link" data-scroll-target="#alpha-beta-in-terms-of-steepness-recruitment">Alpha &amp; Beta in terms of steepness &amp; recruitment</a></li>
  </ul></li>
  <li><a href="#bonus-round-stock-synthesis-recruitment-syntax" id="toc-bonus-round-stock-synthesis-recruitment-syntax" class="nav-link" data-scroll-target="#bonus-round-stock-synthesis-recruitment-syntax">Bonus Round: Stock Synthesis Recruitment Syntax</a></li>
  <li><a href="#yield-and-surplus-production-curves" id="toc-yield-and-surplus-production-curves" class="nav-link" data-scroll-target="#yield-and-surplus-production-curves">Yield and Surplus Production Curves</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Some Algebra for Equilibrium Recruitment</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p> </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 21, 2020</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p>I often find myself revisiting the various “re-arrangements” of the Beverton-Holt stock-recruitment relationship, particularly when moving between equilibrium quantities. I wanted to centralize some algebra for myself and anyone else who uses this relationship regularly.</p>
<section id="the-bev-holt-srr" class="level2">
<h2 class="anchored" data-anchor-id="the-bev-holt-srr">The Bev-Holt SRR</h2>
<p>Let’s start with some working definitions.</p>
<p><span class="math display">\[
\begin{array}
{rr}
R_0 \quad virgin, \quad unfished \quad recruitment \\ SBPR_0 \quad virgin, \quad unfished \quad spawner \quad biomass-per-recruit \\ SSB_0 \quad virgin, \quad unfished \quad spawning \quad biomass \\ SBPR_F \quad  \quad biomass-per-recruit \quad at \quad F \neq 0 \\ SSB_F \quad spawning \quad biomass  \quad at \quad F \neq 0 \\ YPR_F \quad yield-per-recruit \quad at \quad F \neq 0 \\ \end{array}
\]</span></p>
<p>First, let’s illustrate how one strings these quantities together in an age-structured model <em>assuming a stock-recruit relationship</em> to derive equilibrium quantities.</p>
</section>
<section id="yield-per-recruit-quantities-at-various-f" class="level2">
<h2 class="anchored" data-anchor-id="yield-per-recruit-quantities-at-various-f">Yield-per-Recruit quantities at various F</h2>
<ol type="1">
<li>Find <span class="math inline">\(SBPR\)</span> and <span class="math inline">\(YPR\)</span> at your <span class="math inline">\(F\)</span> value of interest, and also calculate these values when <span class="math inline">\(F = 0\)</span>. This will vary slightly depending on the setup of your model, but in pseudo-math: <span class="math inline">\(YPR = \large \Sigma_a \small Fs_aN_aw_a\)</span>, Where <span class="math inline">\(N_a\)</span> is a proportional expected number-at-age, <span class="math inline">\(w_a\)</span> is the expected weight-at-age, and <span class="math inline">\(s_a\)</span> is fishery selectivity. <span class="math display">\[
SBPR = \large \Sigma_a \small E_aN_aw_a
\]</span> Here <span class="math inline">\(E_a\)</span> is some measure of your population’s fecundity at age. The resultant <span class="math inline">\(SBPR\)</span> is going to vary with <span class="math inline">\(F\)</span> because <span class="math inline">\(N_a\)</span> will decline faster when <span class="math inline">\(F\)</span> is greater than zero.</li>
</ol>
</section>
<section id="srr-in-terms-of-sbpr" class="level2">
<h2 class="anchored" data-anchor-id="srr-in-terms-of-sbpr">SRR in terms of SBPR</h2>
<p>2a) Look at your stock-recruitment relationship. <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> are parameters of the Beverton-Holt SRR. We also leverage the definition of equilibrium stock spawning biomass as the product of unfished SBPR and Recruitment. You can confirm this makes sense by describing the equation with words: the virgin/unfished spawning biomass is the expected spawning biomass for one virgin/unfished recruit times the number of recruits. The same relationship will apply for equilibrium biomass. You will need to pick a number (or estimate) <span class="math inline">\(R_0\)</span>.</p>
<p><span class="math display">\[
\begin{array} {rr}
R_F = \frac{SSB_F}{\alpha + \beta SSB_F} \quad Bev-Holt\\
SSB_0 = SBPR_0 \times R_0 \\
SSB_{eq} = SBPR_{eq} \times R_{eq} \\
\end{array}
\]</span> 2b) Re-arrange the SRR to be in terms of <span class="math inline">\(SBPR\)</span>. We do this by substitution. <span class="math display">\[
\begin{array}
{rr}
R_F = \frac{SSB_F}{\alpha + \beta SSB_F} \quad Bev-Holt\\
SSB_{eq} = SBPR_{eq} \times R_{eq} \\
R_{eq} =  \frac{SBPR_{eq} \times R_{eq} }{\alpha + \beta ( SBPR_{eq} \times R_{eq} )} \\
R_{eq}(\alpha + \beta ( SBPR_{eq} \times R_{eq} )) =  SBPR_{eq} \times R_{eq}  \\
\alpha + \beta ( SBPR_{eq} \times R_{eq} ) =  SBPR_{eq}   \\
\beta ( SBPR_{eq} \times R_{eq} ) =  SBPR_{eq} - \alpha  \\
R_{eq}  = \frac{ SBPR_{eq} - \alpha}{\beta \times SBPR_{eq} }  \\
\end{array} \]</span></p>
<section id="alpha-beta-in-terms-of-steepness-recruitment" class="level3">
<h3 class="anchored" data-anchor-id="alpha-beta-in-terms-of-steepness-recruitment">Alpha &amp; Beta in terms of steepness &amp; recruitment</h3>
<ol start="3" type="1">
<li>Sweet, now we need a nice definition for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>. Spoiler: these only vary by <span class="math inline">\(R_0\)</span> and steepness, <span class="math inline">\(h\)</span>, which is defined as the expected recruitment at 20% of <span class="math inline">\(SSB_0\)</span> (hence the 0.2s). Here’s the derivation of those values. Recall that <span class="math inline">\(SSB_0 = SBPR_0 \times R_0\)</span>, meaning <span class="math inline">\(SBPR_0\)</span> can be substituted for <span class="math inline">\(\frac{SSB_0}{R_0}\)</span>. Let’s start with beta:</li>
</ol>
<p><span class="math display">\[
\begin{array}
{cc}
R_0 = \frac{SSB_0}{\alpha + \beta SSB_0} &amp; original \\
\alpha + \beta SSB_0 = \frac{SSB_0}{R_0} &amp; rearrange, \quad sub \\
\alpha =SBPR_0 - \beta SSB_0 &amp; alpha \\
hR_0 = \frac{0.2SSB_0}{\alpha + 0.2 \beta SSB_0} &amp; h @ 0.2SSB_0  \\
hR_0 = \frac{0.2SSB_0}{SBPR_0 - \beta SSB_0 + 0.2 \beta SSB_0} &amp; substitute  \\
hR_0 = \frac{0.2SSB_0}{SBPR_0 - 0.8 \beta SSB_0} &amp; simplify \\
hR_0SBPR_0 - 0.8hR_0\beta SSB_0= 0.2SSB_0 &amp; multiply \quad denom\\
hSSB_0 - 0.8hR_0\beta SSB_0= 0.2SSB_0 &amp; sub \quad SSB_0 = \tilde S R_0\\
h - 0.8hR_0\beta = 0.2 &amp; div \quad SSB_0 \\
5h - 4hR_0\beta = 1 &amp; mult \quad 5 \\
\frac{5h-1}{4hR_0} = \beta &amp; solve \quad \beta \\
\end{array}
\]</span></p>
<p>And now for <span class="math inline">\(\alpha\)</span>, starting at the third equation from above:</p>
<p><span class="math display">\[
\begin{array}
{cc}
\alpha =SBPR_0 - \beta SSB_0 &amp; from \quad above \\
\alpha =SBPR_0 -  \frac{5h-1}{4hR_0}SSB_0 &amp; sub \quad \beta \\
\alpha =SBPR_0 -  \frac{5h-1}{4hR_0}SBPR_0 R_0 &amp; sub \quad SSB_0 = SBPR_0 R_0  \\
\alpha =SBPR_0 -  \frac{5h-1}{4h}SBPR_0 &amp; cancel \quad R_0  \\
\alpha =SBPR_0 \langle1-  \frac{5h-1}{4h}\rangle &amp; factor  \\
\alpha = SBPR_0 \langle \frac{1-h}{4h}\rangle &amp; rearrange   \\
\end{array}
\]</span></p>
<p>To recap, <span class="math inline">\(R_{eq}\)</span> and <span class="math inline">\(SBPR_{eq}\)</span> are both varying with <span class="math inline">\(F\)</span>, but alpha and beta only change with <span class="math inline">\(h\)</span> and <span class="math inline">\(R0\)</span>. <span class="math inline">\(SBPR_{F=0}\)</span> is fixed based on the life history of your species.</p>
</section>
</section>
<section id="bonus-round-stock-synthesis-recruitment-syntax" class="level2">
<h2 class="anchored" data-anchor-id="bonus-round-stock-synthesis-recruitment-syntax">Bonus Round: Stock Synthesis Recruitment Syntax</h2>
<p>Ever wonder where the Beverton-Holt syntax in the Stock Synthesis manual comes from? It is simply the substitution &amp; rearrangement of our derived values for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> into the original stock-recruit relationship. The “trick” (not really) is just leaving the equation for <span class="math inline">\(\alpha\)</span> in terms of virigin biomass and recruitment.</p>
<p><span class="math display">\[
\begin{array}
{rr}
R_F = \frac{SSB_F}{\alpha + \beta SSB_F} \quad Bev-Holt\\
R_F = \frac{SSB_F}{\frac{SSB_0}{R_0} \langle \frac{1-h}{4h}\rangle + \frac{5h-1}{4hR_0} SSB_F} \quad substitute \\
R_F = \frac{SSB_F 4hR_0}{SSB_0(1-h)+ SSB_F(5h-1)} \quad flip \quad denom \\
\end{array}
\]</span></p>
</section>
<section id="yield-and-surplus-production-curves" class="level2">
<h2 class="anchored" data-anchor-id="yield-and-surplus-production-curves">Yield and Surplus Production Curves</h2>
<ol start="4" type="1">
<li>We are almost done. We have equations for equilibrium recruitment, and the definitions for the parameters of that equation. Note that equilibrium recruitment <em>will change</em> with <span class="math inline">\(F\)</span> because <span class="math inline">\(SPBR_F\)</span> changes, whereas alpha and beta will not (this is important later). We can now write down equations for our resultant equilibrium spawning biomass, and equilibrium yields: <span class="math display">\[
\begin{array}
{rr}
SSB_{eq} = R_{eq} \times {SBPR_F} \\
Yield_{eq} = R_{eq} \times {YPR_F}
\end{array}
\]</span> The “yield curve” is simply obtained by re-calculating these values across a range of Fs and plotting the results against input <span class="math inline">\(F\)</span> and/or resultant <span class="math inline">\(SSB\)</span>. The height of the resultant dome is dependent on the value of <span class="math inline">\(h\)</span> used, and the skewness in the biomass is related to selectivity. For the yield curve specifically, the peak occurs at the point just before natural mortality eclipses somatic growth, and the descending limb will be more “bendy” if you are selecting fish far before they mature. Another way of saying this is that the descending limb will accordingly change in height depending at the age of first capture.</li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>